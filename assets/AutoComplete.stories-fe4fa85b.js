import{a as v,j as n,F as I}from"./jsx-runtime-c2efdcba.js";import{a as O}from"./chunk-AY7I2SME-5eb1ab46.js";import{r as s}from"./index-2812c619.js";import{I as J}from"./index-58987b04.js";import{I as K}from"./index-9e51bc7d.js";import{c as X}from"./index-dfa6f321.js";import{T as G}from"./index-5656478a.js";import"./_commonjsHelpers-725317a4.js";import"./inheritsLoose-25350896.js";import"./index-62c31eed.js";function U(e,a=200){const[r,o]=s.useState(e);return s.useEffect(()=>{const g=setTimeout(()=>{o(e)},a);return()=>clearTimeout(g)},[e,a,r]),r}function Z(e,a){s.useEffect(()=>{const r=o=>{!e.current||e.current.contains(o.target)||a(o)};return document.addEventListener("click",r),()=>document.removeEventListener("click",r)},[e,a])}function l(e){const{value:a,renderOption:r,fetchSuggestions:o,onSelect:g,...w}=e,[_,S]=s.useState(a),[i,u]=s.useState([]),[P,N]=s.useState(!1),[c,f]=s.useState(-1),b=s.useRef(!0),h=U(_,b.current?500:0),y=s.useRef(!1),V=s.useRef(null),q=s.useRef(null);Z(V,()=>u([])),s.useEffect(()=>{if(h&&y.current){const t=o(h);b.current=t instanceof Promise,t instanceof Promise?t.then(d=>{u(d)}):u(t)}else u([]);f(-1),N(!1)},[h,o]);const z=t=>{y.current=!0,S(t.target.value.trim()),N(!0)},A=t=>{t<0&&(t=0),t>=i.length&&(t=i.length-1),f(t)},L=t=>{switch(t.key){case"ArrowUp":t.preventDefault(),A(c-1);break;case"ArrowDown":t.preventDefault(),A(c+1);break;case"Escape":u([]);break;case"Enter":i[c]&&C(i[c]);break}},C=t=>{y.current=!1,S(t.value),u([]),g&&g(t)},j=t=>{t!==c&&f(t)},H=t=>n(I,{children:r?r(t):t.value}),M=()=>i.map((t,d)=>{const x=X("ac__suggestion__item",{"ac__suggestion__item-hightlighted":d===c});return n("li",{"data-key":d,className:x,onClick:()=>C(t),onMouseMove:()=>j(d),children:H(t)},d)});return v("div",{className:"ac",ref:V,"data-testid":"test-auto-complete",children:[n(J,{className:"ac__input",value:_,onChange:z,onKeyDown:L,...w}),n(G,{nodeRef:q,in:i.length>0,timeout:300,animationName:"zoom-in-top",children:n("ul",{ref:q,className:"ac__suggestion",children:P?n("li",{className:"ac__suggestion__loading",children:n(K,{icon:"FaSpinner",theme:"primary",spin:!0})}):M()})})]})}try{l.displayName="AutoComplete",l.__docgenInfo={description:"",displayName:"AutoComplete",props:{fetchSuggestions:{defaultValue:null,description:"",name:"fetchSuggestions",required:!0,type:{name:"(str: string) => T[] | Promise<T[]>"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((item: T) => void)"}},renderOption:{defaultValue:null,description:"",name:"renderOption",required:!1,type:{name:"((item: T) => ReactElement<any, string | JSXElementConstructor<any>>)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"lg"'},{value:'"sm"'}]}},prepend:{defaultValue:null,description:"",name:"prepend",required:!1,type:{name:"ReactNode"}},append:{defaultValue:null,description:"",name:"append",required:!1,type:{name:"ReactNode"}}}}}catch{}try{l.displayName="AutoComplete",l.__docgenInfo={description:"",displayName:"AutoComplete",props:{fetchSuggestions:{defaultValue:null,description:"",name:"fetchSuggestions",required:!0,type:{name:"(str: string) => T[] | Promise<T[]>"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((item: T) => void)"}},renderOption:{defaultValue:null,description:"",name:"renderOption",required:!1,type:{name:"((item: T) => ReactElement<any, string | JSXElementConstructor<any>>)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"lg"'},{value:'"sm"'}]}},prepend:{defaultValue:null,description:"",name:"prepend",required:!1,type:{name:"ReactNode"}},append:{defaultValue:null,description:"",name:"append",required:!1,type:{name:"ReactNode"}}}}}catch{}const $=[{value:"Rat",chineseName:"鼠"},{value:"Ox",chineseName:"牛"},{value:"Tiger",chineseName:"虎"},{value:"Rabbit",chineseName:"兔"},{value:"Dragon",chineseName:"龍"},{value:"Snake",chineseName:"蛇"},{value:"Horse",chineseName:"馬"},{value:"Goat",chineseName:"羊"},{value:"Monkey",chineseName:"猴"},{value:"Rooster",chineseName:"雞"},{value:"Dog",chineseName:"狗"},{value:"Pig",chineseName:"豬"}];function B(e){return $.filter(a=>a.value.toLowerCase().includes(e.toLowerCase()))}function Q(e){return fetch(`https://api.github.com/search/users?q=${e}`).then(a=>a.json()).then(({items:a})=>Array.isArray(a)?a.slice(0,10).map(r=>({value:r.login,...r})):[]).catch(()=>[])}const ce={title:"Example/AutoComplete",component:l},W=e=>n(l,{...e}),m=W.bind({});m.args={fetchSuggestions(e){return B(e)},renderOption(e){return v(I,{children:[n("b",{style:{margin:"0 .5rem"},children:e.chineseName}),n("span",{children:e.value})]})},onSelect:O("select")};const Y=e=>n(l,{...e}),p=Y.bind({});p.args={fetchSuggestions(e){return Q(e)},renderOption(e){return v("div",{style:{display:"flex",alignItems:"center",height:"2rem",padding:".25rem"},children:[n("img",{style:{height:"100%",borderRadius:"50%"},src:e.avatar_url,alt:e.value+" avatar"}),n("b",{style:{margin:"0 .5rem"},children:e.value})]})},onSelect:O("select")};var R,T,E;m.parameters={...m.parameters,docs:{...(R=m.parameters)==null?void 0:R.docs,source:{originalSource:"args => <AutoComplete {...args} />",...(E=(T=m.parameters)==null?void 0:T.docs)==null?void 0:E.source}}};var k,F,D;p.parameters={...p.parameters,docs:{...(k=p.parameters)==null?void 0:k.docs,source:{originalSource:"args => <AutoComplete {...args} />",...(D=(F=p.parameters)==null?void 0:F.docs)==null?void 0:D.source}}};const de=["FetchSuggestions","AsyncFetch"];export{p as AsyncFetch,m as FetchSuggestions,de as __namedExportsOrder,ce as default};
//# sourceMappingURL=AutoComplete.stories-fe4fa85b.js.map
