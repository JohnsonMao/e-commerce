var P=Object.defineProperty;var a=(e,n)=>P(e,"name",{value:n,configurable:!0});import{a as T}from"./index-06ba0146.js";import{r}from"./index-a38f3d31.js";import{I as z}from"./index-82e7880c.js";import{I as L}from"./index-3f8b0a6e.js";import{c as j}from"./index-9ad99e66.js";import{T as H}from"./index-124bdaab.js";import{a as y,j as s,F as A}from"./jsx-runtime-69008c6b.js";import"./es.object.get-own-property-descriptor-d261b708.js";import"./iframe-0bdcdd7a.js";import"./web.url.constructor-d5d56621.js";import"./es.number.is-integer-1cb564d8.js";import"./make-decorator-3cd8a5d0.js";import"./index-b042d21f.js";function M(e,n=200){const[l,i]=r.useState(e);return r.useEffect(()=>{const p=setTimeout(()=>{i(e)},n);return()=>clearTimeout(p)},[e,n,l]),l}a(M,"useDebounce");function x(e,n){r.useEffect(()=>{const l=a(i=>{!e.current||e.current.contains(i.target)||n(i)},"listener");return document.addEventListener("click",l),()=>document.removeEventListener("click",l)},[e,n])}a(x,"useClickOutside");function o(e){const{value:n,renderOption:l,fetchSuggestions:i,onSelect:p,...C}=e,[v,_]=r.useState(n),[u,c]=r.useState([]),[E,N]=r.useState(!1),[d,f]=r.useState(-1),S=r.useRef(!0),g=M(v,S.current?500:0),h=r.useRef(!1),b=r.useRef(null),V=r.useRef(null);x(b,()=>c([])),r.useEffect(()=>{if(g&&h.current){const t=i(g);S.current=t instanceof Promise,t instanceof Promise?t.then(m=>{c(m)}):c(t)}else c([]);f(-1),N(!1)},[g,i]);const k=a(t=>{h.current=!0,_(t.target.value.trim()),N(!0)},"handleChange"),q=a(t=>{t<0&&(t=0),t>=u.length&&(t=u.length-1),f(t)},"highlight"),F=a(t=>{switch(t.key){case"ArrowUp":t.preventDefault(),q(d-1);break;case"ArrowDown":t.preventDefault(),q(d+1);break;case"Escape":c([]);break;case"Enter":u[d]&&R(u[d]);break}},"handleKeyDown"),R=a(t=>{h.current=!1,_(t.value),c([]),p&&p(t)},"handleSelect"),D=a(t=>{t!==d&&f(t)},"handleHover"),I=a(t=>s(A,{children:l?l(t):t.value}),"renderTemplate"),O=a(()=>u.map((t,m)=>{const w=j("ac__suggestion__item",{"ac__suggestion__item-hightlighted":m===d});return s("li",{"data-key":m,className:w,onClick:()=>R(t),onMouseMove:()=>D(m),children:I(t)},m)}),"generateDropdown");return y("div",{className:"ac",ref:b,"data-testid":"test-auto-complete",children:[s(z,{className:"ac__input",value:v,onChange:k,onKeyDown:F,...C}),s(H,{nodeRef:V,in:u.length>0,timeout:300,animationName:"zoom-in-top",children:s("ul",{ref:V,className:"ac__suggestion",children:E?s("li",{className:"ac__suggestion__loading",children:s(L,{icon:"FaSpinner",theme:"primary",spin:!0})}):O()})})]})}a(o,"AutoComplete");try{o.displayName="AutoComplete",o.__docgenInfo={description:"",displayName:"AutoComplete",props:{fetchSuggestions:{defaultValue:null,description:"",name:"fetchSuggestions",required:!0,type:{name:"(str: string) => T[] | Promise<T[]>"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((item: T) => void)"}},renderOption:{defaultValue:null,description:"",name:"renderOption",required:!1,type:{name:"((item: T) => ReactElement<any, string | JSXElementConstructor<any>>)"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"lg"'},{value:'"sm"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},prepend:{defaultValue:null,description:"",name:"prepend",required:!1,type:{name:"ReactNode"}},append:{defaultValue:null,description:"",name:"append",required:!1,type:{name:"ReactNode"}}}}}catch{}try{o.displayName="AutoComplete",o.__docgenInfo={description:"",displayName:"AutoComplete",props:{fetchSuggestions:{defaultValue:null,description:"",name:"fetchSuggestions",required:!0,type:{name:"(str: string) => T[] | Promise<T[]>"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((item: T) => void)"}},renderOption:{defaultValue:null,description:"",name:"renderOption",required:!1,type:{name:"((item: T) => ReactElement<any, string | JSXElementConstructor<any>>)"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"lg"'},{value:'"sm"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},prepend:{defaultValue:null,description:"",name:"prepend",required:!1,type:{name:"ReactNode"}},append:{defaultValue:null,description:"",name:"append",required:!1,type:{name:"ReactNode"}}}}}catch{}const J=[{value:"Rat",chineseName:"鼠"},{value:"Ox",chineseName:"牛"},{value:"Tiger",chineseName:"虎"},{value:"Rabbit",chineseName:"兔"},{value:"Dragon",chineseName:"龍"},{value:"Snake",chineseName:"蛇"},{value:"Horse",chineseName:"馬"},{value:"Goat",chineseName:"羊"},{value:"Monkey",chineseName:"猴"},{value:"Rooster",chineseName:"雞"},{value:"Dog",chineseName:"狗"},{value:"Pig",chineseName:"豬"}];function K(e){return J.filter(n=>n.value.toLowerCase().includes(e.toLowerCase()))}a(K,"testFetchSuggestions");function X(e){return fetch(`https://api.github.com/search/users?q=${e}`).then(n=>n.json()).then(({items:n})=>Array.isArray(n)?n.slice(0,10).map(l=>({value:l.login,...l})):[]).catch(()=>[])}a(X,"testAsyncFetchSuggestions");const ce={title:"Example/AutoComplete",component:o},G=a(e=>s(o,{...e}),"FetchSuggestionsTemplate"),U=G.bind({});U.args={fetchSuggestions(e){return K(e)},renderOption(e){return y(A,{children:[s("b",{style:{margin:"0 .5rem"},children:e.chineseName}),s("span",{children:e.value})]})},onSelect:T("select")};const Z=a(e=>s(o,{...e}),"AsyncFetchTemplate"),$=Z.bind({});$.args={fetchSuggestions(e){return X(e)},renderOption(e){return y("div",{style:{display:"flex",alignItems:"center",height:"2rem",padding:".25rem"},children:[s("img",{style:{height:"100%",borderRadius:"50%"},src:e.avatar_url,alt:e.value+" avatar"}),s("b",{style:{margin:"0 .5rem"},children:e.value})]})},onSelect:T("select")};const de=["FetchSuggestions","AsyncFetch"];export{$ as AsyncFetch,U as FetchSuggestions,de as __namedExportsOrder,ce as default};
//# sourceMappingURL=AutoComplete.stories-14bfb6b2.js.map
